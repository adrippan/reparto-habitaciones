<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reparto Habitaciones</title>
  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json"/>
  <!-- Brython -->
  <script src="https://cdn.jsdelivr.net/npm/brython@3.9.5/brython.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/brython@3.9.5/brython_stdlib.min.js"></script>
</head>
<body onload="brython()">

  <h1>Reparto de Habitaciones</h1>

  <div>
    <label>Habitaciones h (JSON):<br>
      <textarea id="h" rows="2">[20,6,8,10,20,1,1,1,1,1,1,1,1,1,1,1,1,1,1]</textarea>
    </label>
  </div>

  <div>
    <label>Grupos g (JSON):<br>
      <textarea id="g" rows="2">[20,3,4,5,6]</textarea>
    </label>
  </div>

  <div>
    <label>Mapping (JSON):<br>
      <textarea id="mapping" rows="2">{"0":"C","1":"A","2":"B","3":"R","4":"I","5":"L","6":"LL","7":"A2","8":"S","9":"M1","10":"M2","11":"M3","12":"M4","13":"M5","14":"M6","15":"M7","16":"M8","17":"M9","18":"M10"}</textarea>
    </label>
  </div>

  <div style="margin:1em 0;">
    <button id="btn" type="button">Asignar</button>
  </div>

  <pre id="output" style="white-space: pre-wrap; border:1px solid #ccc; padding:8px;"></pre>

  <!-- Tu script Python -->
  <script type="text/python" src="repartoHabitaciones.py"></script>

  <!-- Binding y lógica Brython -->
  <script type="text/python">
from browser import document
import json
import repartoHabitaciones as rh

def run(ev=None):
    out_el = document["output"]
    try:
        h = json.loads(document["h"].value)
        g = json.loads(document["g"].value)
        mapping = json.loads(document["mapping"].value)
    except Exception as e:
        out_el.text = f"Error al parsear JSON:\n{e}"
        return

    try:
        sol, vacias = rh.repartoHabitaciones(h, g)
    except Exception as e:
        out_el.text = f"Error en repartoHabitaciones:\n{e}"
        return

    lines = []
    for i, hab in enumerate(sol[0]):
        num = i // 2 + 1
        sexo = "CHICOS" if i % 2 == 0 else "CHICAS"
        lines.append(f"G{num}: {sexo} → habitación {mapping.get(str(hab), hab)}")
    lines.append(f"\nHabitaciones vacías: {vacias}")

    out_el.text = "\n".join(lines)

document["btn"].bind("click", run)
  </script>

</body>
</html>
